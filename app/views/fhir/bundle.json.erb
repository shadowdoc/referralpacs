{
    "resourceType": "Bundle",
    "type": "searchset",
    "total": <%= @encounters.length -%>,
    "entry": [
        <% @encounters.each_with_index do |e, i| -%>
        {
            "fullUrl": "<%= request.protocol + request.host_with_port -%>/fhir/diagnosticreport/<%=e.id -%>",
            "resource": <%= render partial: 'diagnosticreport', locals: {e: e} %>
        }<%= ',' if i < (@encounters.length - 1) %>
        <% end -%>

    ]
}